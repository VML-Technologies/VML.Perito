# Modelos de Base de Datos y Relaciones

## Estructura de Modelos

- Usar `createModelWithSoftDeletes` de [baseModel.js](mdc:apps/server/models/baseModel.js) para todos los modelos
- Definir relaciones en [index.js](mdc:apps/server/models/index.js)
- Usar nombres descriptivos para las asociaciones (ej: `AssignedAgent`, `Creator`)

## Relaciones Principales

- **InspectionOrder**: Entidad central con relaciones a User, Sede, InspectionOrderStatus
- **Appointment**: Relacionado con InspectionOrder, Sede, InspectionModality
- **CallLog**: Registro de llamadas relacionado con InspectionOrder y User
- **User**: Entidad central con roles y permisos (RBAC)

## Convenciones de Nomenclatura

- **Tablas**: snake_case (ej: `inspection_orders`, `call_logs`)
- **Modelos**: PascalCase (ej: `InspectionOrder`, `CallLog`)
- **Campos**: snake_case en BD, camelCase en JavaScript
- **Relaciones**: Usar alias descriptivos (ej: `AssignedAgent`, `Creator`)

## Validaciones Importantes

- Verificar que las foreign keys existan en la BD antes de crear relaciones
- Usar `allowNull: false` para campos obligatorios
- Definir índices para campos frecuentemente consultados
- Agregar constraints de foreign key en la BD

## Migraciones

- Crear scripts de migración en `scripts/` para cambios estructurales
- Usar `sequelize.sync()` solo en desarrollo
- Documentar cambios en la estructura de BD
  description:
  globs:
  alwaysApply: false

---
