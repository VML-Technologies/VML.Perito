# Frontend Development Patterns

## Component Structure

### Functional Components with Hooks

Always use functional components with React hooks:

```javascript
import React, { useState, useEffect, useRef, forwardRef, useImperativeHandle } from 'react';

const MyComponent = forwardRef((props, ref) => {
  const [state, setState] = useState(initialValue);
  const internalRef = useRef(null);

  useEffect(() => {
    // Side effects
  }, [dependencies]);

  useImperativeHandle(ref, () => ({
    // Expose methods to parent
    someMethod: () => {
      /* implementation */
    },
  }));

  return <div>{/* JSX content */}</div>;
});

export default MyComponent;
```

### Component Communication

Use refs for direct method calls between components:

```javascript
// Parent component
const childRef = useRef(null);

const handleAction = () => {
  childRef.current.someMethod();
};

return <ChildComponent ref={childRef} />;

// Child component
const ChildComponent = forwardRef((props, ref) => {
  useImperativeHandle(ref, () => ({
    someMethod: () => {
      /* implementation */
    },
  }));
});
```

## State Management

### Local State

Use `useState` for component-local state:

```javascript
const [data, setData] = useState([]);
const [loading, setLoading] = useState(false);
const [error, setError] = useState(null);
```

### Data Fetching

Use `useEffect` for data fetching:

```javascript
useEffect(() => {
  const fetchData = async () => {
    setLoading(true);
    try {
      const response = await fetch('/api/endpoint');
      const result = await response.json();
      setData(result.data);
    } catch (error) {
      setError(error.message);
    } finally {
      setLoading(false);
    }
  };

  fetchData();
}, [dependencies]);
```

## Data Mapping

### API to Component Format

Transform API data to component format:

```javascript
// API format: { template: "content" }
// Component format: { body: "content", message: "content" }

const mapApiToComponent = (apiData) => ({
  body: apiData.template || '',
  message: apiData.template || '',
  title: apiData.subject || '',
});

const mapComponentToApi = (componentData) => ({
  template: componentData.body || componentData.message || '',
  subject: componentData.title || '',
});
```

### Variable Handling

Handle template variables consistently:

```javascript
// Extract variables from template
const extractVariables = (template) => {
  const variablePattern = /\{\{([^}]+)\}\}/g;
  const variables = [];
  let match;
  while ((match = variablePattern.exec(template)) !== null) {
    variables.push(match[1]);
  }
  return variables;
};

// Insert variable into editor
const insertVariable = (variable) => {
  const variableText = `{{${variable}}}`;
  // Insert into active editor field
};
```

## Custom Hooks

### API Hooks

Create custom hooks for API operations:

```javascript
const useApi = (endpoint) => {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);

  const fetchData = async () => {
    setLoading(true);
    try {
      const token = localStorage.getItem('authToken');
      const response = await fetch(endpoint, {
        headers: {
          Authorization: `Bearer ${token}`,
          'Content-Type': 'application/json',
        },
      });
      const result = await response.json();
      setData(result.data);
    } catch (error) {
      setError(error.message);
    } finally {
      setLoading(false);
    }
  };

  return { data, loading, error, fetchData };
};
```

### Notification Hooks

Use the notification context for user feedback:

```javascript
import { useNotifications } from '../hooks/use-notifications.js';

const { showToast } = useNotifications();

// Success notification
showToast({
  type: 'success',
  title: 'Éxito',
  message: 'Operación completada exitosamente',
});

// Error notification
showToast({
  type: 'error',
  title: 'Error',
  message: 'Ha ocurrido un error inesperado',
});
```

## Error Handling

### Component Error Boundaries

Implement error boundaries for component error handling:

```javascript
const ErrorBoundary = ({ children }) => {
  const [hasError, setHasError] = useState(false);

  if (hasError) {
    return <div>Algo salió mal. Intenta recargar la página.</div>;
  }

  return children;
};
```

### API Error Handling

Handle API errors gracefully:

```javascript
const handleApiCall = async () => {
  try {
    const response = await fetch('/api/endpoint');
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    }
    const data = await response.json();
    return data;
  } catch (error) {
    console.error('API Error:', error);
    showToast({
      type: 'error',
      title: 'Error',
      message: 'Error al procesar la solicitud',
    });
    throw error;
  }
};
```

## UI Components

### Consistent Styling

Use the UI component library consistently:

```javascript
import { Card, Button, Input, Select, Badge } from '../components/ui';

// Use consistent spacing and layout
<div className="space-y-4 p-6">
  <Card className="p-4">
    <h2 className="text-lg font-semibold mb-4">Título</h2>
    <div className="space-y-2">{/* Content */}</div>
  </Card>
</div>;
```

### Responsive Design

Implement responsive design patterns:

```javascript
// Use Tailwind responsive classes
<div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
    {/* Responsive grid */}
</div>

// Hide/show elements based on screen size
<div className="hidden sm:block">Desktop only</div>
<div className="block sm:hidden">Mobile only</div>
```

## Performance Optimization

### Memoization

Use `useMemo` and `useCallback` for expensive operations:

```javascript
const expensiveValue = useMemo(() => {
  return computeExpensiveValue(data);
}, [data]);

const handleClick = useCallback(() => {
  // Handle click
}, [dependencies]);
```

### Lazy Loading

Implement lazy loading for large components:

```javascript
const LazyComponent = React.lazy(() => import('./LazyComponent'));

// Wrap in Suspense
<Suspense fallback={<div>Cargando...</div>}>
  <LazyComponent />
</Suspense>;
```

description:
globs:
alwaysApply: false

---
