---
description: GuÃ­a completa de debugging y troubleshooting para VML.Perito, incluyendo errores comunes de backend (sintaxis, mÃ³dulos, controladores), problemas de base de datos (columnas, asociaciones), errores de frontend (componentes, API), herramientas de debugging (console logging, React DevTools), prevenciÃ³n de errores, y monitoreo de rendimiento.
alwaysApply: false
---

# Debugging and Troubleshooting Guide

## Common Backend Errors

### Server Startup Issues

#### 1. SyntaxError: Identifier has already been declared

**Problem**: Duplicate imports in [apps/server/index.js](mdc:apps/server/index.js)
**Solution**: Remove duplicate import statements

```javascript
// âŒ Problem
import eventController from './controllers/eventController.js';
import eventController as eventControllerAlias from './controllers/eventController.js';

// âœ… Solution
import eventController from './controllers/eventController.js';
```

#### 2. ERR_MODULE_NOT_FOUND: Cannot find package

**Problem**: Missing npm packages
**Solution**: Install required packages

```bash
cd apps/server && npm install compression morgan express-rate-limit helmet
```

#### 3. SyntaxError: The requested module does not provide an export named 'default'

**Problem**: Controller not exporting default instance
**Solution**: Add default export to controller

```javascript
// Add to end of controller file
export default new ControllerName();
```

#### 4. TypeError: argument handler must be a function

**Problem**: Route handler is not a valid function
**Solution**: Ensure controller methods exist and are properly exported

```javascript
// Check that method exists in controller
app.get('/api/endpoint', controller.methodName);
```

### Database Issues

#### 1. Unknown column errors

**Problem**: Database schema mismatch
**Solution**: Check model definitions and run migrations

```javascript
// Check model definition
const Model = sequelize.define('Model', {
  columnName: DataType.STRING,
});
```

#### 2. Association errors

**Problem**: Model associations not established
**Solution**: Import models index file

```javascript
// Add to file that uses associations
import '../models/index.js';
```

#### 3. SequelizeEagerLoadingError: Model is not associated

**Problem**: Missing association definition
**Solution**: Define associations in models

```javascript
Model.belongsTo(RelatedModel, { as: 'relation' });
RelatedModel.hasMany(Model, { as: 'relations' });
```

## Common Frontend Errors

### Component Issues

#### 1. TypeError: showNotification is not a function

**Problem**: Wrong hook method name
**Solution**: Use correct method from notification hook

```javascript
// âŒ Problem
const { showNotification } = useNotifications();

// âœ… Solution
const { showToast } = useNotifications();
```

#### 2. Component not rendering content

**Problem**: Data format mismatch between API and component
**Solution**: Implement data mapping

```javascript
// Map API data to component format
useEffect(() => {
  if (apiData) {
    const mappedData = mapApiToComponent(apiData);
    setComponentData(mappedData);
  }
}, [apiData]);
```

#### 3. Variable selector not working

**Problem**: Component communication issue
**Solution**: Use refs for direct method calls

```javascript
// Parent component
const editorRef = useRef(null);
const handleVariableSelect = (variable) => {
  editorRef.current.insertVariable(variable);
};

// Child component
const EditorComponent = forwardRef((props, ref) => {
  useImperativeHandle(ref, () => ({
    insertVariable: (variable) => {
      /* implementation */
    },
  }));
});
```

### API Issues

#### 1. 401 Unauthorized errors

**Problem**: Authentication token issues
**Solution**: Check token storage and usage

```javascript
// Check localStorage key
const token = localStorage.getItem('authToken'); // Not 'token'

// Include in headers
headers: {
    'Authorization': `Bearer ${token}`,
    'Content-Type': 'application/json'
}
```

#### 2. 500 Internal Server Error

**Problem**: Backend processing error
**Solution**: Check server logs and implement proper error handling

```javascript
// Backend error handling
try {
  // Implementation
} catch (error) {
  console.error('Error details:', error);
  res.status(500).json({
    success: false,
    message: 'Error al procesar la solicitud',
    error: error.message,
  });
}
```

## Debugging Tools and Techniques

### Backend Debugging

#### 1. Console Logging

Add detailed logging to trace execution:

```javascript
console.log('Request body:', req.body);
console.log('User data:', req.user);
console.log('Processing step:', 'description');
```

#### 2. Database Query Logging

Enable Sequelize query logging:

```javascript
const sequelize = new Sequelize(config.database, config.username, config.password, {
  ...config,
  logging: console.log, // Enable query logging
});
```

#### 3. Request/Response Logging

Use middleware for comprehensive logging:

```javascript
app.use((req, res, next) => {
  console.log(`ðŸ” ${req.method} ${req.path} - IP: ${req.realIP}`);
  // ... logging implementation
});
```

### Frontend Debugging

#### 1. Browser Console

Check for JavaScript errors and API responses:

```javascript
// Add debugging logs
console.log('Component state:', state);
console.log('API response:', response);
console.log('Error details:', error);
```

#### 2. Network Tab

Monitor API requests and responses:

- Check request headers (Authorization, Content-Type)
- Verify request payload format
- Review response status codes and data

#### 3. React DevTools

Inspect component state and props:

- Check component hierarchy
- Monitor state changes
- Verify prop passing

## Error Prevention

### Backend Prevention

#### 1. Input Validation

Always validate incoming data:

```javascript
const validateInput = (data) => {
  if (!data.requiredField) {
    throw new Error('Required field missing');
  }
  // Additional validation
};
```

#### 2. Error Boundaries

Implement proper error handling:

```javascript
try {
  // Risky operation
} catch (error) {
  console.error('Operation failed:', error);
  // Handle gracefully
}
```

#### 3. Type Checking

Use JSDoc or TypeScript for type safety:

```javascript
/**
 * @param {Object} data - Input data
 * @param {string} data.name - Template name
 * @returns {Promise<Object>} Created template
 */
async function createTemplate(data) {
  // Implementation
}
```

### Frontend Prevention

#### 1. Loading States

Always show loading states during async operations:

```javascript
const [loading, setLoading] = useState(false);

const handleSubmit = async () => {
  setLoading(true);
  try {
    await apiCall();
  } finally {
    setLoading(false);
  }
};
```

#### 2. Error States

Handle and display errors gracefully:

```javascript
const [error, setError] = useState(null);

if (error) {
  return <div className="error">Error: {error}</div>;
}
```

#### 3. Data Validation

Validate data before processing:

```javascript
const validateForm = (data) => {
  const errors = {};
  if (!data.name) errors.name = 'Name is required';
  return errors;
};
```

## Performance Monitoring

### Backend Performance

- Monitor response times in logs
- Check database query performance
- Monitor memory usage
- Track error rates

### Frontend Performance

- Monitor component render times
- Check bundle size
- Monitor API call frequency
- Track user interaction performance
  description:
  globs:
  alwaysApply: false

---
